FROM archlinux
MAINTAINER Jan Jirak

RUN pacman -Sy --noconfirm bash fish sudo vim && pacman -Scc --noconfirm

# set up users and passwords
RUN useradd -m -s /bin/fish somebody \
  && echo 'somebody ALL=(ALL) ALL' > /etc/sudoers.d/somebody \
  && echo "somebody:fiat-trying-forty" | chpasswd \
  && echo "root:video-speedy-torment" | chpasswd

COPY --chown=somebody:somebody . /home/somebody/linux_environment
WORKDIR /home/somebody/linux_environment
USER root
RUN ./install_tools.fish
USER somebody
RUN ./setup_env.fish

CMD ["/bin/bash"]
